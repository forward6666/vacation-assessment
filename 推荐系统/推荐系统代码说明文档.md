## 推荐系统代码说明文档

### 总纲

本项目基于surprise库，并借助sklearn机器学习库编写，数据集采用surprise库中自带的MovieLens 1M数据集，使用混合推荐系统（切换混合），即在不同的应用情况下选择最为合适的推荐机制。

### 数据预处理

数据集包含三个文件：

| 文件名      | 内容                                                         |
| ----------- | ------------------------------------------------------------ |
| users.dat   | 文件存放的是用户的相关信息，包括性别、年龄、职业，该文件中每条记录形式：UserID::Gender::Age::Occupation::Zip-code |
| movies.dat  | 文件存放的是电影的相关信息，该文件中每条记录形式：MovieID::Title::Genres |
| ratings.dat | 文件存放的是用户对电影的评分信息，改文件中每条记录形式：UserID::MovieID::Rating::Timestamp，即用户id、电影id、该用户对此电影的评分值、时间戳 |

#### 基本处理

1、在将movies.dat文件读取为dataframe格式之后，基于Genres列创建TF-IDF矩阵以及各个电影之间的相似度矩阵，以便后续进行基于内容推荐。

2、读取ratings.dat文件，并按2：8的比例分测试集与训练集。

### 模型结构

#### 1、基于协同过滤的推荐

对数据集中的用户进行新电影推荐使用基于协同过滤的推荐，这里使用基于模型的协同过滤：奇异值分解（SVD）。

损失函数：均根方误差（rmse）

优化算法：网格搜索

#### 2、基于内容的推荐

通过数据预处理阶段求得的相似度矩阵进行推荐

#### 3、冷启动问题

对于新用户以及新电影皆使用基于内容的推荐

### 结果测试

![ca6345d2d63fee6215cee5027b433a8](https://github.com/user-attachments/assets/963e83a3-2ff6-4953-92ee-58e7394bcac5)
